<div class="bg-primary-blue-dark text-white py-16">
  <div class="container mx-auto px-4">
    <nav class="flex items-center gap-2 text-sm mb-4">
      <a routerLink="/" class="hover:text-primary-gold transition-colors">Home</a>
      <i class="fas fa-chevron-right"></i>
      <span class="text-primary-gold">The Secretary's Office</span>
    </nav>
    <h1 class="font-cinzel text-4xl md:text-5xl font-bold">The Secretary's Office</h1>
    <p class="text-lg mt-4 text-primary-gold-light">Communications and Updates from the Lodge Secretary</p>
  </div>
</div>

<div class="container mx-auto px-4 py-12">
  <!-- Introduction -->
  <div class="max-w-4xl mx-auto mb-12">
    <div class="bg-white border border-gray-200 rounded-lg shadow-md p-8">
      <div class="flex items-center mb-6">
        <i class="fas fa-user-tie text-primary-gold text-3xl mr-4"></i>
        <div>
          <h2 class="font-cinzel text-2xl text-primary-blue font-bold">From the Secretary's Desk</h2>
          <p class="text-gray-600">Stay informed with the latest lodge communications</p>
        </div>
      </div>
      <p class="text-gray-700 leading-relaxed">
        Welcome to the Secretary's Office. Here you'll find important updates about our lodge activities, 
        meeting summaries, upcoming events, and special announcements. We encourage all members to stay 
        connected with lodge activities and participate in our fraternal fellowship.
      </p>
    </div>
  </div>

  <!-- Secretary's Updates Sections -->
  <div *ngIf="secretaryData$ | async as data" class="grid lg:grid-cols-2 gap-8 mb-12">
    <!-- What You Missed -->
    <div class="bg-neutral-light border border-gray-200 rounded-lg shadow-md overflow-hidden">
      <div class="bg-primary-blue text-white p-6">
        <div class="flex items-center">
          <i class="fas fa-history text-primary-gold text-2xl mr-3"></i>
          <h3 class="font-cinzel text-xl font-bold">What You Missed at the Last Meeting</h3>
        </div>
      </div>
      <div class="p-6">
        <div class="content-section">
          <!-- Meeting Quote - always show this -->
          <div class="meeting-quote">
            <p>
              <i class="fas fa-utensils mr-2"></i>
              It really goes without saying... If you miss a meeting, you miss a Fantastic Meal!!
            </p>
          </div>
          

          
          <div class="highlights-section" *ngIf="data.lastMeeting.metadata?.highlights">
            <h4>Meeting Highlights</h4>
            <ul>
              <li *ngFor="let highlight of data.lastMeeting.metadata?.highlights || []">• {{ highlight }}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- What You Will Miss -->
    <div class="bg-neutral-light border border-gray-200 rounded-lg shadow-md overflow-hidden">
      <div class="bg-primary-gold text-primary-blue-darker p-6">
        <div class="flex items-center">
          <i class="fas fa-exclamation-triangle text-primary-blue-darker text-2xl mr-3"></i>
          <h3 class="font-cinzel text-xl font-bold">What You Will Miss if You Don't Attend the Next Meeting</h3>
        </div>
      </div>
      <div class="p-6">
        <div class="content-section">
          <div class="meeting-content secretary-content" [innerHTML]="data.nextMeeting.content | cleanWordPressContent"></div>
          
          <div class="highlights-section" *ngIf="data.nextMeeting.metadata?.next_meeting_highlights">
            <h4>What to Expect</h4>
            <ul>
              <li *ngFor="let highlight of data.nextMeeting.metadata?.next_meeting_highlights || []">• {{ highlight }}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Birthdays and Anniversaries -->
  <div *ngIf="secretaryData$ | async as data" class="bg-white border border-gray-200 rounded-lg shadow-md mb-12">
    <div class="bg-gradient-to-r from-primary-blue to-primary-blue-dark text-white p-6">
      <div class="flex items-center">
        <i class="fas fa-birthday-cake text-primary-gold text-2xl mr-3"></i>
        <h3 class="font-cinzel text-xl font-bold">Birthdays and Masonic Anniversaries</h3>
      </div>
    </div>
    <div class="p-6">
      <div class="grid md:grid-cols-2 gap-8">
        <!-- December Birthdays -->
        <div>
          <h4 class="font-cinzel text-lg text-primary-blue font-bold mb-4 flex items-center">
            <i class="fas fa-gift text-primary-gold mr-2"></i>
            December Birthdays
          </h4>
          <div class="max-h-80 overflow-y-auto space-y-2">
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Henry Tillman Barron</span>
              <span class="text-gray-600">Dec 3</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Miles Bradley Beamguard</span>
              <span class="text-gray-600">Dec 3</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Alan Henry Hays</span>
              <span class="text-gray-600">Dec 3</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Henry Abraham Swett</span>
              <span class="text-gray-600">Dec 4</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Woodrow Wilson Ellison</span>
              <span class="text-gray-600">Dec 5</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Ernest Frank Hensley</span>
              <span class="text-gray-600">Dec 6</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Richard Arlen Reed</span>
              <span class="text-gray-600">Dec 6</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Wyatt Keith Wright</span>
              <span class="text-gray-600">Dec 6</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Leo Laskin</span>
              <span class="text-gray-600">Dec 7</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">George Priestley Hall, Jr.</span>
              <span class="text-gray-600">Dec 9</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Steven Walter Aspinall</span>
              <span class="text-gray-600">Dec 11</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Ronald William Oughton</span>
              <span class="text-gray-600">Dec 12</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Robert Manton Peruche</span>
              <span class="text-gray-600">Dec 13</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Walter Michael Culotta Jr</span>
              <span class="text-gray-600">Dec 14</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Allen Robert Crim</span>
              <span class="text-gray-600">Dec 18</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Dean Joseph Bolvin</span>
              <span class="text-gray-600">Dec 19</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Lee Craig Hoelzle</span>
              <span class="text-gray-600">Dec 22</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Mark Steven Hanisee</span>
              <span class="text-gray-600">Dec 23</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Gary Curtis Long</span>
              <span class="text-gray-600">Dec 25</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">William Clyde Shadley II</span>
              <span class="text-gray-600">Dec 25</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Randy Lee Byrnes</span>
              <span class="text-gray-600">Dec 26</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Ronald Clayton Newton</span>
              <span class="text-gray-600">Dec 26</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Daniel Edward Wise</span>
              <span class="text-gray-600">Dec 27</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Paul Garrett Hayes III</span>
              <span class="text-gray-600">Dec 28</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Anthony Pio Pine</span>
              <span class="text-gray-600">Dec 28</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">James Bradford Birdsong</span>
              <span class="text-gray-600">Dec 29</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Craig Robert Hull</span>
              <span class="text-gray-600">Dec 29</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">John David Sloat</span>
              <span class="text-gray-600">Dec 29</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-neutral-light rounded text-sm">
              <span class="font-medium">Samuel Buck Jr</span>
              <span class="text-gray-600">Dec 31</span>
            </div>
          </div>
          
          <!-- Birthday Statistics -->
          <div class="mt-4 p-4 bg-primary-gold-light rounded-lg">
            <h5 class="font-semibold text-primary-blue mb-2">Of our 29 Brothers with December Birthdays:</h5>
            <div class="text-sm text-gray-700 space-y-1">
              <div>• One was born in the 1930's</div>
              <div>• Six were born in the 1940's</div>
              <div>• Three were born in the 1950's</div>
              <div>• Four were born in the 1960's</div>
              <div>• Five were born in the 1970's</div>
              <div>• Seven were born in the 1980's</div>
              <div>• Three were born in the 1990's</div>
            </div>
            <p class="text-primary-blue font-semibold mt-3 text-center">
              <i class="fas fa-birthday-cake mr-2"></i>
              We wish each and every Brother a Very Happy Birthday!!
            </p>
          </div>
        </div>

        <!-- December Masonic Anniversaries (Raising Dates) -->
        <div>
          <h4 class="font-cinzel text-lg text-primary-blue font-bold mb-4 flex items-center">
            <i class="fas fa-medal text-primary-gold mr-2"></i>
            December Masonic Anniversaries
          </h4>
          <div class="max-h-80 overflow-y-auto space-y-2">
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Robert Guy Kirkpatrick</span>
              <span class="text-primary-blue font-bold">54 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Simon Francis Pels</span>
              <span class="text-primary-blue font-bold">52 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Robert George Faustino</span>
              <span class="text-primary-blue font-bold">50 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Daniel Raymond Spencer</span>
              <span class="text-primary-blue font-bold">48 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Daniel Edward Wise</span>
              <span class="text-primary-blue font-bold">48 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Maynard Roger Hardin</span>
              <span class="text-primary-blue font-bold">42 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">John Edward Gunter</span>
              <span class="text-primary-blue font-bold">41 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Denny Wayne Pieczonka</span>
              <span class="text-primary-blue font-bold">28 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Kenneth Charles Silkie</span>
              <span class="text-primary-blue font-bold">27 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Larry Carl Roach</span>
              <span class="text-primary-blue font-bold">25 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">James Lynwood Mann</span>
              <span class="text-primary-blue font-bold">23 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Ricardo Luis Colon-Marquez</span>
              <span class="text-primary-blue font-bold">21 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">James Joseph Burrows</span>
              <span class="text-primary-blue font-bold">19 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">David Anthony Wirth</span>
              <span class="text-primary-blue font-bold">17 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Kevin David Hudson</span>
              <span class="text-primary-blue font-bold">13 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">Michael Lee Jernigan</span>
              <span class="text-primary-blue font-bold">13 years</span>
            </div>
            <div class="flex justify-between items-center p-2 bg-primary-gold-light rounded text-sm">
              <span class="font-medium">James Bradford Birdsong</span>
              <span class="text-primary-blue font-bold">4 years</span>
            </div>
          </div>
          
          <!-- Anniversary Statistics -->
          <div class="mt-4 p-4 bg-primary-blue-light rounded-lg">
            <h5 class="font-semibold text-primary-blue mb-2">Of the 17 Brothers Raised in December:</h5>
            <div class="text-sm text-gray-700 space-y-1">
              <div>• Three were Raised in the 1970's</div>
              <div>• Three were Raised in the 1980's</div>
              <div>• One was Raised in the 1990's</div>
              <div>• Four were Raised in the 2000's</div>
              <div>• Five were Raised in the 2010's</div>
              <div>• One was Raised in the 2020's</div>
            </div>
            <p class="text-sm text-gray-600 mt-3 italic">
              December marks significant milestones, with several Brothers celebrating 40+ years since their Raising.
            </p>
            <p class="text-primary-blue font-semibold mt-3 text-center">
              Brothers, whether you were Raised 54 years ago or 4 years ago, your Lodge congratulates you and thanks you for your continuous support!
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Coming Months -->
  <div class="bg-white border border-gray-200 rounded-lg shadow-md mb-12">
    <div class="bg-primary-blue-dark text-white p-6">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <i class="fas fa-calendar-alt text-primary-gold text-2xl mr-3"></i>
          <h3 class="font-cinzel text-xl font-bold">What You Can Look Forward to in the Coming Months</h3>
        </div>
        <div *ngIf="isLoadingEvents" class="flex items-center text-primary-gold">
          <i class="fas fa-spinner fa-spin mr-2"></i>
          <span class="text-sm">Loading events...</span>
        </div>
      </div>
    </div>
    <div class="p-6">
      <!-- Loading State -->
      <div *ngIf="isLoadingEvents" class="grid md:grid-cols-3 gap-6">
        <div *ngFor="let item of [1,2,3]" class="animate-pulse">
          <div class="bg-gray-200 rounded-full w-16 h-16 mx-auto mb-3"></div>
          <div class="bg-gray-200 h-6 w-20 mx-auto mb-2 rounded"></div>
          <div class="bg-gray-200 h-4 w-full mb-1 rounded"></div>
          <div class="bg-gray-200 h-4 w-3/4 mx-auto rounded"></div>
        </div>
      </div>

      <!-- Real Events Display -->
      <div *ngIf="!isLoadingEvents && upcomingEvents.length > 0">
        <!-- Month Preview Cards -->
        <div class="grid md:grid-cols-3 gap-6 mb-8">
          <div *ngFor="let monthData of getNext3MonthsPreview(); let i = index" class="text-center">
            <div [ngClass]="{
              'bg-primary-gold text-primary-blue-darker': i === 0,
              'bg-primary-blue text-white': i === 1,
              'bg-primary-gold-light text-primary-blue': i === 2
            }" class="rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-3">
              <i [class]="'text-xl ' + getIconClassForMonth(monthData)"></i>
            </div>
            <h4 class="font-cinzel text-lg text-primary-blue font-bold mb-2">{{ monthData.month }}</h4>
            <p class="text-gray-600 text-sm">
              {{ monthData.events.length }} scheduled event{{ monthData.events.length !== 1 ? 's' : '' }}
            </p>
            <div class="mt-2 text-xs text-gray-500">
              <div *ngFor="let event of monthData.events.slice(0, 2)" class="truncate">
                {{ event.title }}
              </div>
              <div *ngIf="monthData.events.length > 2" class="text-primary-blue font-medium">
                +{{ monthData.events.length - 2 }} more
              </div>
            </div>
          </div>
        </div>



        <!-- Lodge Highlights -->
        <div class="border-t pt-6 mb-6">
          <h4 class="font-cinzel text-lg text-primary-blue font-bold mb-4 flex items-center">
            <i class="fas fa-star mr-2 text-primary-gold"></i>
            What to Look Forward To
          </h4>
          <div class="grid md:grid-cols-2 gap-4 mb-6">
            <div class="bg-primary-gold-light p-4 rounded-lg">
              <h5 class="font-semibold text-primary-blue mb-2">
                <i class="fas fa-newspaper mr-2"></i>The Return of the Trestle Board
              </h5>
              <p class="text-sm text-gray-700">Stay informed with our restored lodge newsletter</p>
            </div>
            <div class="bg-primary-blue-light p-4 rounded-lg">
              <h5 class="font-semibold text-primary-blue mb-2">
                <i class="fas fa-building mr-2"></i>New Building Updates
              </h5>
              <p class="text-sm text-gray-700">Progress reports on our lodge improvements</p>
            </div>
            <div class="bg-neutral-light p-4 rounded-lg">
              <h5 class="font-semibold text-primary-blue mb-2">
                <i class="fas fa-book mr-2"></i>Virtual Masonic Library
              </h5>
              <p class="text-sm text-gray-700">Access countless Masonic books and papers</p>
            </div>
            <div class="bg-primary-gold-light p-4 rounded-lg">
              <h5 class="font-semibold text-primary-blue mb-2">
                <i class="fas fa-users mr-2"></i>New Teams & Training
              </h5>
              <p class="text-sm text-gray-700">Join our Funeral Team, become a Mentor or Catechism coach</p>
            </div>
          </div>
        </div>

        <!-- Detailed Events List -->
        <div class="border-t pt-6">
          <h4 class="font-cinzel text-lg text-primary-blue font-bold mb-4 flex items-center">
            <i class="fas fa-list mr-2 text-primary-gold"></i>
            Upcoming Lodge Events
          </h4>
          <div class="space-y-3">
            <div *ngFor="let event of upcomingEvents.slice(0, 8); trackBy: trackByEventId" 
                 class="flex items-start gap-4 p-4 bg-neutral-light rounded-lg hover:shadow-md transition-shadow">
              <div class="bg-primary-blue text-white rounded-lg min-w-16 h-16 flex flex-col items-center justify-center flex-shrink-0">
                <span class="text-lg font-bold">{{ event.date | date:'d' }}</span>
                <span class="text-xs uppercase">{{ event.date | date:'MMM' }}</span>
              </div>
              <div class="flex-1 min-w-0">
                <h5 class="font-semibold text-primary-blue mb-1">{{ event.title }}</h5>
                <div class="flex flex-wrap gap-4 text-sm text-gray-600 mb-2">
                  <span class="flex items-center">
                    <i class="fas fa-clock mr-1 text-primary-gold"></i>
                    {{ event.startTime }} - {{ event.endTime }}
                  </span>
                  <span class="flex items-center" *ngIf="event.location">
                    <i class="fas fa-map-marker-alt mr-1 text-primary-gold"></i>
                    {{ event.location }}
                  </span>
                </div>
                <p *ngIf="event.description" class="text-sm text-gray-700 line-clamp-2">
                  {{ event.description }}
                </p>
                <span class="inline-block mt-2 px-2 py-1 text-xs rounded-full" 
                      [class]="getEventTypeClass(event.type)">
                  {{ event.type | titlecase }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- No Events State -->
      <div *ngIf="!isLoadingEvents && upcomingEvents.length === 0" class="text-center py-8">
        <i class="fas fa-calendar-times text-gray-400 text-4xl mb-4"></i>
        <h4 class="text-gray-600 font-semibold mb-2">No Upcoming Events</h4>
        <p class="text-gray-500">Check back later for updates on lodge activities and events.</p>
      </div>
    </div>
  </div>

  <!-- Full Secretary Content from WordPress -->
  <div *ngIf="secretaryData$ | async as data" class="bg-white border border-gray-200 rounded-lg shadow-md mb-12">
    <div class="bg-gradient-to-r from-primary-blue to-primary-blue-dark text-white p-6">
      <div class="flex items-center">
        <i class="fas fa-file-alt text-primary-gold text-2xl mr-3"></i>
        <h3 class="font-cinzel text-xl font-bold">Complete Secretary's Report</h3>
      </div>
    </div>
    <div class="p-8">
      <div class="prose prose-lg max-w-none">
        <div class="meeting-content secretary-content space-y-4 leading-relaxed" [innerHTML]="data.lastMeeting.content | cleanWordPressContent"></div>
      </div>
    </div>
  </div>

  <!-- Call to Action -->
  <div class="text-center py-8">
    <div class="bg-gradient-to-r from-primary-blue to-primary-blue-dark text-white p-8 rounded-lg shadow-md">
      <h3 class="font-cinzel text-2xl font-bold mb-4">Stay Connected</h3>
      <p class="text-lg mb-6 text-primary-gold-light">
        Don't miss out on important lodge communications and fellowship opportunities.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a routerLink="/calendar" 
           class="inline-flex items-center bg-primary-gold hover:bg-primary-gold-dark text-primary-blue-darker px-6 py-3 rounded-md transition-colors font-semibold">
          <i class="fas fa-calendar-alt mr-2"></i>
          View Full Calendar
        </a>
        <a routerLink="/contact" 
           class="inline-flex items-center bg-white hover:bg-gray-100 text-primary-blue px-6 py-3 rounded-md transition-colors font-semibold">
          <i class="fas fa-envelope mr-2"></i>
          Contact Secretary
        </a>
      </div>
    </div>
  </div>
</div>
